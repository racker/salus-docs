@startuml

title Monitor File Upload/Delete

actor User
participant MonitorMgmt as MM
database DB
participant Ambassador as Amb
participant Envoy

== User requests Monitor with File upload ==

User -> MM: POST Monitor with file
MM -> DB: saves file as mediumblob, creates bm with hashes, renders template vars
MM -> Amb: bound monitor event
DB -> Amb: get bound monitor with hashes
Amb -> Envoy: send config op with hashes
Envoy -> Amb: if hashes dont match, request new zipfiles
Amb -> Envoy: send zip files
Envoy -> Envoy: unzip files

== User deletes Monitor with File ==

User -> MM: Delete Monitor with file
MM -> DB: deletes monitor/bm's
MM -> Amb: bound monitor event
Amb -> Envoy: send delete config op
Envoy -> Envoy: delete files


@enduml